HasN
====






.. toctree::
   :maxdepth: 3
   :titlesonly:


   HasN/NonPersistedNodeError

   HasN/AssociationProxy

   

   

   

   

   

   

   

   

   HasN/ClassMethods

   HasN/Association




Constants
---------





Files
-----



  * `lib/neo4j/active_node/has_n.rb:2 <https://github.com/neo4jrb/neo4j/blob/master/lib/neo4j/active_node/has_n.rb#L2>`_

  * `lib/neo4j/active_node/has_n/association.rb:5 <https://github.com/neo4jrb/neo4j/blob/master/lib/neo4j/active_node/has_n/association.rb#L5>`_





Methods
-------



.. _`Neo4j/ActiveNode/HasN#association_proxy`:

**#association_proxy**
  

  .. hidden-code-block:: ruby

     def association_proxy(name, options = {})
       name = name.to_sym
       hash = [name, options.values_at(:node, :rel)].hash
     
       association_proxy_cache_fetch(hash) do
         if previous_association_proxy = self.instance_variable_get('@association_proxy')
           result_by_previous_id = previous_association_proxy_results_by_previous_id(previous_association_proxy, name)
     
           previous_association_proxy.result.inject(nil) do |proxy_to_return, object|
             proxy = fresh_association_proxy(name, options, result_by_previous_id[object.neo_id])
     
             object.association_proxy_cache[hash] = proxy
     
             (self == object ? proxy : proxy_to_return)
           end
         else
           fresh_association_proxy(name, options)
         end
       end
     end



.. _`Neo4j/ActiveNode/HasN#association_proxy_cache`:

**#association_proxy_cache**
  Returns the current AssociationProxy cache for the association cache. It is in the format
  { :association_name => AssociationProxy}
  This is so that we
  * don't need to re-build the QueryProxy objects
  * also because the QueryProxy object caches it's results
  * so we don't need to query again
  * so that we can cache results from association calls or eager loading

  .. hidden-code-block:: ruby

     def association_proxy_cache
       @association_proxy_cache ||= {}
     end



.. _`Neo4j/ActiveNode/HasN#association_proxy_cache_fetch`:

**#association_proxy_cache_fetch**
  

  .. hidden-code-block:: ruby

     def association_proxy_cache_fetch(key)
       association_proxy_cache.fetch(key) do
         value = yield
         association_proxy_cache[key] = value
       end
     end



.. _`Neo4j/ActiveNode/HasN#association_query_proxy`:

**#association_query_proxy**
  

  .. hidden-code-block:: ruby

     def association_query_proxy(name, options = {})
       self.class.send(:association_query_proxy, name, {start_object: self}.merge(options))
     end



.. _`Neo4j/ActiveNode/HasN#cypher_hash`:

**#cypher_hash**
  Uses the cypher generated by a QueryProxy object, complete with params, to generate a basic non-cryptographic hash
  for use in @association_cache.

  .. hidden-code-block:: ruby

     def cypher_hash(cypher_string)
       cypher_string.hash.abs
     end





